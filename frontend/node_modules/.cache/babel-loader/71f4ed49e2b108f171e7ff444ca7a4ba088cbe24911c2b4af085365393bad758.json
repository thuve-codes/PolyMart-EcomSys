{"ast":null,"code":"import{useState,useEffect}from'react';import{useParams}from'react-router-dom';import{toast}from'react-toastify';import ChatPopup from\"../components/Chatpopup\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ProductDetail(_ref){let{cartItems,setCartItems}=_ref;const API_URL=\"http://localhost:5001\";const[product,setProduct]=useState(null);const[qty,setQty]=useState(1);const[isPopupOpen,setIsPopupOpen]=useState(false);const{id}=useParams();useEffect(()=>{fetch(`${API_URL}/api/v1/product/`+id).then(response=>response.json()).then(response=>{// Ensure price is a number\nconst productData=response.product;productData.price=Number(productData.price);setProduct(productData);}).catch(error=>console.error(\"Error fetching product:\",error));},[id]);function addToCart(){if(!product)return;if(product.stock===0){toast.error('This item is out of stock and cannot be added to cart');return;}if(qty>product.stock){toast.error(`Only ${product.stock} items available in stock`);return;}const itemExist=cartItems.find(item=>item.product._id===product._id);if(!itemExist){const newItem={product,qty};setCartItems(state=>[...state,newItem]);toast.success('Item added to cart successfully');}else{toast.warning('Item already in cart');}}function increaseQty(){if(product&&qty<product.stock){setQty(prevQty=>prevQty+1);}else{toast.info(`Maximum available quantity is ${product.stock}`);}}function decreaseQty(){if(qty>1)setQty(state=>state-1);}const togglePopup=()=>{setIsPopupOpen(!isPopupOpen);};return product&&/*#__PURE__*/_jsx(\"div\",{className:\"container container-fluid\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row f-flex justify-content-around\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-lg-5 img-fluid\",id:\"product_image\",children:/*#__PURE__*/_jsx(\"img\",{src:product.images[0].image,alt:product.name,height:\"500\",width:\"500\",style:{objectFit:'contain'}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-12 col-lg-5 mt-5\",children:[/*#__PURE__*/_jsx(\"h3\",{children:product.name}),/*#__PURE__*/_jsxs(\"p\",{id:\"product_id\",children:[\"Product # \",product._id]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"rating-outer\",children:/*#__PURE__*/_jsx(\"div\",{className:\"rating-inner\",style:{width:`${product.ratings/5*100}%`}})}),product.numOfReviews&&/*#__PURE__*/_jsxs(\"span\",{id:\"no_of_reviews\",children:[\"(\",product.numOfReviews,\" reviews)\"]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{id:\"product_price\",children:[\"Rs \",typeof product.price==='number'?product.price.toFixed(2):product.price]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stockCounter d-inline\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"btn btn-danger minus\",onClick:decreaseQty,children:\"-\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control count d-inline\",value:qty,readOnly:true}),/*#__PURE__*/_jsx(\"span\",{className:\"btn btn-primary plus\",onClick:increaseQty,children:\"+\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:addToCart,disabled:product.stock===0,id:\"cart_btn\",className:\"btn btn-primary d-inline ml-4\",style:{opacity:product.stock===0?0.5:1},children:product.stock===0?'Out of Stock':'Add to Cart'}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Status:\",/*#__PURE__*/_jsx(\"span\",{id:\"stock_status\",className:product.stock>0?'text-success':'text-danger',children:product.stock>0?`In Stock (${product.stock} available)`:'Out of Stock'})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h4\",{className:\"mt-2\",children:\"Description:\"}),/*#__PURE__*/_jsx(\"p\",{children:product.description}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{id:\"product_seller mb-3\",children:[\"Sold by: \",/*#__PURE__*/_jsx(\"strong\",{children:product.seller})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rating w-50\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:togglePopup,className:\"btn btn-info mt-2\",style:{padding:\"10px 20px\"},children:\"Chat with Seller\"}),isPopupOpen&&/*#__PURE__*/_jsx(ChatPopup,{productName:product.name,sellerName:product.seller,isOpen:isPopupOpen,togglePopup:togglePopup})]})]})]})});}","map":{"version":3,"names":["useState","useEffect","useParams","toast","ChatPopup","jsx","_jsx","jsxs","_jsxs","ProductDetail","_ref","cartItems","setCartItems","API_URL","product","setProduct","qty","setQty","isPopupOpen","setIsPopupOpen","id","fetch","then","response","json","productData","price","Number","catch","error","console","addToCart","stock","itemExist","find","item","_id","newItem","state","success","warning","increaseQty","prevQty","info","decreaseQty","togglePopup","className","children","src","images","image","alt","name","height","width","style","objectFit","ratings","numOfReviews","toFixed","onClick","type","value","readOnly","disabled","opacity","description","seller","padding","productName","sellerName","isOpen"],"sources":["C:/Users/thuve/Desktop/myCodes/Docker/PolyMart-EcomSys/frontend/src/pages/ProductDetail.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { toast } from 'react-toastify';\r\nimport ChatPopup from \"../components/Chatpopup\";\r\n\r\nexport default function ProductDetail({ cartItems, setCartItems }) {\r\n    const API_URL = \"http://localhost:5001\";\r\n    const [product, setProduct] = useState(null);\r\n    const [qty, setQty] = useState(1);\r\n    const [isPopupOpen, setIsPopupOpen] = useState(false);\r\n\r\n    const { id } = useParams();\r\n\r\n    useEffect(() => {\r\n        fetch(`${API_URL}/api/v1/product/` + id)\r\n            .then(response => response.json())\r\n            .then(response => {\r\n                // Ensure price is a number\r\n                const productData = response.product;\r\n                productData.price = Number(productData.price);\r\n                setProduct(productData);\r\n            })\r\n            .catch(error => console.error(\"Error fetching product:\", error));\r\n    }, [id]);\r\n\r\n    function addToCart() {\r\n        if (!product) return;\r\n        \r\n        if (product.stock === 0) {\r\n            toast.error('This item is out of stock and cannot be added to cart');\r\n            return;\r\n        }\r\n        \r\n        if (qty > product.stock) {\r\n            toast.error(`Only ${product.stock} items available in stock`);\r\n            return;\r\n        }\r\n        \r\n        const itemExist = cartItems.find((item) => item.product._id === product._id);\r\n        if (!itemExist) {\r\n            const newItem = { product, qty };\r\n            setCartItems((state) => [...state, newItem]);\r\n            toast.success('Item added to cart successfully');\r\n        } else {\r\n            toast.warning('Item already in cart');\r\n        }\r\n    }\r\n\r\n    function increaseQty() {\r\n        if (product && qty < product.stock) {\r\n            setQty((prevQty) => prevQty + 1);\r\n        } else {\r\n            toast.info(`Maximum available quantity is ${product.stock}`);\r\n        }\r\n    }\r\n\r\n    function decreaseQty() {\r\n        if (qty > 1) setQty((state) => state - 1);\r\n    }\r\n\r\n    const togglePopup = () => {\r\n        setIsPopupOpen(!isPopupOpen);\r\n    };\r\n\r\n    return (\r\n        product &&\r\n        <div className=\"container container-fluid\">\r\n            <div className=\"row f-flex justify-content-around\">\r\n                <div className=\"col-12 col-lg-5 img-fluid\" id=\"product_image\">\r\n                    <img \r\n                        src={product.images[0].image} \r\n                        alt={product.name} \r\n                        height=\"500\" \r\n                        width=\"500\" \r\n                        style={{ objectFit: 'contain' }}\r\n                    />\r\n                </div>\r\n\r\n                <div className=\"col-12 col-lg-5 mt-5\">\r\n                    <h3>{product.name}</h3>\r\n                    <p id=\"product_id\">Product # {product._id}</p>\r\n                    <hr />\r\n\r\n                    <div className=\"rating-outer\">\r\n                        <div \r\n                            className=\"rating-inner\" \r\n                            style={{ width: `${(product.ratings / 5) * 100}%` }}\r\n                        ></div>\r\n                    </div>\r\n                    {product.numOfReviews && (\r\n                        <span id=\"no_of_reviews\">({product.numOfReviews} reviews)</span>\r\n                    )}\r\n\r\n                    <hr />\r\n\r\n                    <p id=\"product_price\">Rs {typeof product.price === 'number' ? product.price.toFixed(2) : product.price}</p>\r\n                    \r\n                    <div className=\"stockCounter d-inline\">\r\n                        <span className=\"btn btn-danger minus\" onClick={decreaseQty}>-</span>\r\n                        <input \r\n                            type=\"number\" \r\n                            className=\"form-control count d-inline\" \r\n                            value={qty} \r\n                            readOnly \r\n                        />\r\n                        <span className=\"btn btn-primary plus\" onClick={increaseQty}>+</span>\r\n                    </div>\r\n\r\n                    <button \r\n                        type=\"button\" \r\n                        onClick={addToCart} \r\n                        disabled={product.stock === 0} \r\n                        id=\"cart_btn\" \r\n                        className=\"btn btn-primary d-inline ml-4\"\r\n                        style={{ opacity: product.stock === 0 ? 0.5 : 1 }}\r\n                    >\r\n                        {product.stock === 0 ? 'Out of Stock' : 'Add to Cart'}\r\n                    </button>\r\n\r\n                    <hr />\r\n\r\n                    <p>Status: \r\n                        <span \r\n                            id=\"stock_status\" \r\n                            className={product.stock > 0 ? 'text-success' : 'text-danger'}\r\n                        >\r\n                            {product.stock > 0 ? `In Stock (${product.stock} available)` : 'Out of Stock'}\r\n                        </span>\r\n                    </p>\r\n\r\n                    <hr />\r\n\r\n                    <h4 className=\"mt-2\">Description:</h4>\r\n                    <p>{product.description}</p>\r\n\r\n                    <hr />\r\n                    <p id=\"product_seller mb-3\">\r\n                        Sold by: <strong>{product.seller}</strong>\r\n                    </p>\r\n\r\n                    <div className=\"rating w-50\">\r\n                        <button \r\n                            onClick={togglePopup} \r\n                            className=\"btn btn-info mt-2\"\r\n                            style={{ padding: \"10px 20px\" }}\r\n                        >\r\n                            Chat with Seller\r\n                        </button>\r\n                        \r\n                        {isPopupOpen && (\r\n                            <ChatPopup\r\n                                productName={product.name}\r\n                                sellerName={product.seller}\r\n                                isOpen={isPopupOpen}\r\n                                togglePopup={togglePopup}\r\n                            />\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,OAASC,SAAS,KAAQ,kBAAkB,CAC5C,OAASC,KAAK,KAAQ,gBAAgB,CACtC,MAAO,CAAAC,SAAS,KAAM,yBAAyB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEhD,cAAe,SAAS,CAAAC,aAAaA,CAAAC,IAAA,CAA8B,IAA7B,CAAEC,SAAS,CAAEC,YAAa,CAAC,CAAAF,IAAA,CAC7D,KAAM,CAAAG,OAAO,CAAG,uBAAuB,CACvC,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGf,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACgB,GAAG,CAAEC,MAAM,CAAC,CAAGjB,QAAQ,CAAC,CAAC,CAAC,CACjC,KAAM,CAACkB,WAAW,CAAEC,cAAc,CAAC,CAAGnB,QAAQ,CAAC,KAAK,CAAC,CAErD,KAAM,CAAEoB,EAAG,CAAC,CAAGlB,SAAS,CAAC,CAAC,CAE1BD,SAAS,CAAC,IAAM,CACZoB,KAAK,CAAC,GAAGR,OAAO,kBAAkB,CAAGO,EAAE,CAAC,CACnCE,IAAI,CAACC,QAAQ,EAAIA,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAC,CACjCF,IAAI,CAACC,QAAQ,EAAI,CACd;AACA,KAAM,CAAAE,WAAW,CAAGF,QAAQ,CAACT,OAAO,CACpCW,WAAW,CAACC,KAAK,CAAGC,MAAM,CAACF,WAAW,CAACC,KAAK,CAAC,CAC7CX,UAAU,CAACU,WAAW,CAAC,CAC3B,CAAC,CAAC,CACDG,KAAK,CAACC,KAAK,EAAIC,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAAC,CACxE,CAAC,CAAE,CAACT,EAAE,CAAC,CAAC,CAER,QAAS,CAAAW,SAASA,CAAA,CAAG,CACjB,GAAI,CAACjB,OAAO,CAAE,OAEd,GAAIA,OAAO,CAACkB,KAAK,GAAK,CAAC,CAAE,CACrB7B,KAAK,CAAC0B,KAAK,CAAC,uDAAuD,CAAC,CACpE,OACJ,CAEA,GAAIb,GAAG,CAAGF,OAAO,CAACkB,KAAK,CAAE,CACrB7B,KAAK,CAAC0B,KAAK,CAAC,QAAQf,OAAO,CAACkB,KAAK,2BAA2B,CAAC,CAC7D,OACJ,CAEA,KAAM,CAAAC,SAAS,CAAGtB,SAAS,CAACuB,IAAI,CAAEC,IAAI,EAAKA,IAAI,CAACrB,OAAO,CAACsB,GAAG,GAAKtB,OAAO,CAACsB,GAAG,CAAC,CAC5E,GAAI,CAACH,SAAS,CAAE,CACZ,KAAM,CAAAI,OAAO,CAAG,CAAEvB,OAAO,CAAEE,GAAI,CAAC,CAChCJ,YAAY,CAAE0B,KAAK,EAAK,CAAC,GAAGA,KAAK,CAAED,OAAO,CAAC,CAAC,CAC5ClC,KAAK,CAACoC,OAAO,CAAC,iCAAiC,CAAC,CACpD,CAAC,IAAM,CACHpC,KAAK,CAACqC,OAAO,CAAC,sBAAsB,CAAC,CACzC,CACJ,CAEA,QAAS,CAAAC,WAAWA,CAAA,CAAG,CACnB,GAAI3B,OAAO,EAAIE,GAAG,CAAGF,OAAO,CAACkB,KAAK,CAAE,CAChCf,MAAM,CAAEyB,OAAO,EAAKA,OAAO,CAAG,CAAC,CAAC,CACpC,CAAC,IAAM,CACHvC,KAAK,CAACwC,IAAI,CAAC,iCAAiC7B,OAAO,CAACkB,KAAK,EAAE,CAAC,CAChE,CACJ,CAEA,QAAS,CAAAY,WAAWA,CAAA,CAAG,CACnB,GAAI5B,GAAG,CAAG,CAAC,CAAEC,MAAM,CAAEqB,KAAK,EAAKA,KAAK,CAAG,CAAC,CAAC,CAC7C,CAEA,KAAM,CAAAO,WAAW,CAAGA,CAAA,GAAM,CACtB1B,cAAc,CAAC,CAACD,WAAW,CAAC,CAChC,CAAC,CAED,MACI,CAAAJ,OAAO,eACPR,IAAA,QAAKwC,SAAS,CAAC,2BAA2B,CAAAC,QAAA,cACtCvC,KAAA,QAAKsC,SAAS,CAAC,mCAAmC,CAAAC,QAAA,eAC9CzC,IAAA,QAAKwC,SAAS,CAAC,2BAA2B,CAAC1B,EAAE,CAAC,eAAe,CAAA2B,QAAA,cACzDzC,IAAA,QACI0C,GAAG,CAAElC,OAAO,CAACmC,MAAM,CAAC,CAAC,CAAC,CAACC,KAAM,CAC7BC,GAAG,CAAErC,OAAO,CAACsC,IAAK,CAClBC,MAAM,CAAC,KAAK,CACZC,KAAK,CAAC,KAAK,CACXC,KAAK,CAAE,CAAEC,SAAS,CAAE,SAAU,CAAE,CACnC,CAAC,CACD,CAAC,cAENhD,KAAA,QAAKsC,SAAS,CAAC,sBAAsB,CAAAC,QAAA,eACjCzC,IAAA,OAAAyC,QAAA,CAAKjC,OAAO,CAACsC,IAAI,CAAK,CAAC,cACvB5C,KAAA,MAAGY,EAAE,CAAC,YAAY,CAAA2B,QAAA,EAAC,YAAU,CAACjC,OAAO,CAACsB,GAAG,EAAI,CAAC,cAC9C9B,IAAA,QAAK,CAAC,cAENA,IAAA,QAAKwC,SAAS,CAAC,cAAc,CAAAC,QAAA,cACzBzC,IAAA,QACIwC,SAAS,CAAC,cAAc,CACxBS,KAAK,CAAE,CAAED,KAAK,CAAE,GAAIxC,OAAO,CAAC2C,OAAO,CAAG,CAAC,CAAI,GAAG,GAAI,CAAE,CAClD,CAAC,CACN,CAAC,CACL3C,OAAO,CAAC4C,YAAY,eACjBlD,KAAA,SAAMY,EAAE,CAAC,eAAe,CAAA2B,QAAA,EAAC,GAAC,CAACjC,OAAO,CAAC4C,YAAY,CAAC,WAAS,EAAM,CAClE,cAEDpD,IAAA,QAAK,CAAC,cAENE,KAAA,MAAGY,EAAE,CAAC,eAAe,CAAA2B,QAAA,EAAC,KAAG,CAAC,MAAO,CAAAjC,OAAO,CAACY,KAAK,GAAK,QAAQ,CAAGZ,OAAO,CAACY,KAAK,CAACiC,OAAO,CAAC,CAAC,CAAC,CAAG7C,OAAO,CAACY,KAAK,EAAI,CAAC,cAE3GlB,KAAA,QAAKsC,SAAS,CAAC,uBAAuB,CAAAC,QAAA,eAClCzC,IAAA,SAAMwC,SAAS,CAAC,sBAAsB,CAACc,OAAO,CAAEhB,WAAY,CAAAG,QAAA,CAAC,GAAC,CAAM,CAAC,cACrEzC,IAAA,UACIuD,IAAI,CAAC,QAAQ,CACbf,SAAS,CAAC,6BAA6B,CACvCgB,KAAK,CAAE9C,GAAI,CACX+C,QAAQ,MACX,CAAC,cACFzD,IAAA,SAAMwC,SAAS,CAAC,sBAAsB,CAACc,OAAO,CAAEnB,WAAY,CAAAM,QAAA,CAAC,GAAC,CAAM,CAAC,EACpE,CAAC,cAENzC,IAAA,WACIuD,IAAI,CAAC,QAAQ,CACbD,OAAO,CAAE7B,SAAU,CACnBiC,QAAQ,CAAElD,OAAO,CAACkB,KAAK,GAAK,CAAE,CAC9BZ,EAAE,CAAC,UAAU,CACb0B,SAAS,CAAC,+BAA+B,CACzCS,KAAK,CAAE,CAAEU,OAAO,CAAEnD,OAAO,CAACkB,KAAK,GAAK,CAAC,CAAG,GAAG,CAAG,CAAE,CAAE,CAAAe,QAAA,CAEjDjC,OAAO,CAACkB,KAAK,GAAK,CAAC,CAAG,cAAc,CAAG,aAAa,CACjD,CAAC,cAET1B,IAAA,QAAK,CAAC,cAENE,KAAA,MAAAuC,QAAA,EAAG,SACC,cAAAzC,IAAA,SACIc,EAAE,CAAC,cAAc,CACjB0B,SAAS,CAAEhC,OAAO,CAACkB,KAAK,CAAG,CAAC,CAAG,cAAc,CAAG,aAAc,CAAAe,QAAA,CAE7DjC,OAAO,CAACkB,KAAK,CAAG,CAAC,CAAG,aAAalB,OAAO,CAACkB,KAAK,aAAa,CAAG,cAAc,CAC3E,CAAC,EACR,CAAC,cAEJ1B,IAAA,QAAK,CAAC,cAENA,IAAA,OAAIwC,SAAS,CAAC,MAAM,CAAAC,QAAA,CAAC,cAAY,CAAI,CAAC,cACtCzC,IAAA,MAAAyC,QAAA,CAAIjC,OAAO,CAACoD,WAAW,CAAI,CAAC,cAE5B5D,IAAA,QAAK,CAAC,cACNE,KAAA,MAAGY,EAAE,CAAC,qBAAqB,CAAA2B,QAAA,EAAC,WACf,cAAAzC,IAAA,WAAAyC,QAAA,CAASjC,OAAO,CAACqD,MAAM,CAAS,CAAC,EAC3C,CAAC,cAEJ3D,KAAA,QAAKsC,SAAS,CAAC,aAAa,CAAAC,QAAA,eACxBzC,IAAA,WACIsD,OAAO,CAAEf,WAAY,CACrBC,SAAS,CAAC,mBAAmB,CAC7BS,KAAK,CAAE,CAAEa,OAAO,CAAE,WAAY,CAAE,CAAArB,QAAA,CACnC,kBAED,CAAQ,CAAC,CAER7B,WAAW,eACRZ,IAAA,CAACF,SAAS,EACNiE,WAAW,CAAEvD,OAAO,CAACsC,IAAK,CAC1BkB,UAAU,CAAExD,OAAO,CAACqD,MAAO,CAC3BI,MAAM,CAAErD,WAAY,CACpB2B,WAAW,CAAEA,WAAY,CAC5B,CACJ,EACA,CAAC,EACL,CAAC,EACL,CAAC,CACL,CAAC,CAEd","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}